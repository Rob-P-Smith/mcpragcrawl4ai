[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid

[program:api-server]
command=sh -c "chown -R apiuser:apiuser /app/data && exec su -s /bin/sh apiuser -c 'python3 /app/start_api_server.py'"
directory=/app
user=root
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/api-server.err.log
stdout_logfile=/var/log/supervisor/api-server.out.log
environment=PYTHONPATH="/app",HOME="/home/apiuser",HF_HOME="/app/data/models"

[program:mcp-server]
command=socat TCP-LISTEN:3000,reuseaddr,fork EXEC:'python3 /app/core/rag_processor.py'
directory=/app
user=apiuser
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/mcp-server.err.log
stdout_logfile=/var/log/supervisor/mcp-server.out.log
environment=PYTHONPATH="/app",HOME="/home/apiuser",HF_HOME="/app/data/models"
